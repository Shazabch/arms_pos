{*7/9/2009 4:07:15 PM Andy- add cost and gp9/7/2009 3:56:54 PM Andy- add show by year1/21/2010 5:28:38 PM Andy- change data range selection6/3/2010 3:22:20 PM Andy- Fix javascript error bugs5/12/2011 2:50:31 PM Alex- add use hq cost7/16/2013 11:44 AM Fithri- add option to select price type to group as 'Others'- the word "Compare with" change to "Compare Total with"1/23/2015 5:40 PM Justin- Enhanced to add a note that shows this report is exclude GST.7/24/2015 2:18 PM Joo Chia- Enhance to show cost for every price type.07/01/2016 14:00 Edwin- Show 'HQ Cost' when branch is HQ and $config.sku_listing_show_hq_cost is enabled*}{include file=header.tpl}{if !$no_header_footer}<!-- calendar stylesheet --><link rel="stylesheet" type="text/css" media="all" href="js/jscalendar/calendar-blue.css" title="calendar-blue" /><!-- main calendar program --><script type="text/javascript" src="js/jscalendar/calendar.js"></script><!-- language for the calendar --><script type="text/javascript" src="js/jscalendar/lang/calendar-en.js"></script><!-- the following script defines the Calendar.setup helper function, which makes   adding a calendar a matter of 1 or 2 lines of code. --><script type="text/javascript" src="js/jscalendar/calendar-setup.js"></script><style>{literal}.total_col{	background-color:#ff9;}.total_col2{	background-color:#ddf;}.total_col3{    background-color:#ddd;}{/literal}</style><script>var sort_by = '{$smarty.request.sort_by}';var phpself = '{$smarty.server.PHP_SELF}';{literal}function change_sort_by(ele){	if(ele.value=='')   $('span_sort_order').hide();	else    $('span_sort_order').show();}function toggle_compare_others(){	var is_checked = document.f_a['compare_others'].checked;		if(is_checked){		document.f_a['date_from2'].disabled = false;		document.f_a['date_to2'].disabled = false;	}else{    document.f_a['date_from2'].disabled = true;		document.f_a['date_to2'].disabled = true;	}}{/literal}</script>{/if}<h1>{$PAGE_TITLE}</h1>{if $err}The following error(s) has occured:<ul class=err>{foreach from=$err item=e}<li> {$e}{/foreach}</ul>{/if}{if !$no_header_footer}<form method=post class=form name="f_a"><span class="span_month"><b>From</b> <input size=10 type=text name=date_from value="{$smarty.request.date_from}" id="date_from" readonly><img align=absmiddle src="ui/calendar.gif" id="t_added1" style="cursor: pointer;" title="Select Date">&nbsp;&nbsp;&nbsp;&nbsp;<b>To</b> <input size=10 type=text name=date_to value="{$smarty.request.date_to}" id="date_to" readonly><img align=absmiddle src="ui/calendar.gif" id="t_added2" style="cursor: pointer;" title="Select Date">&nbsp;&nbsp;&nbsp;&nbsp;{if $BRANCH_CODE eq 'HQ'}&nbsp;<b>Branch Group</b> <select name="bg_id">	    <option value="-10000">All</option>	    {if $branch_group.header}			{foreach from=$branch_group.header item=r}			    <option value="{$r.id}" {if $smarty.request.bg_id eq $r.id}selected {/if}>{$r.code}</option>			{/foreach}		{/if}	</select>&nbsp;&nbsp;&nbsp;&nbsp;{/if}&nbsp;<b>Sort by</b><select name="sort_by" onChange="change_sort_by(this);">	<option value="">--</option>	<option value="branch_code" {if $smarty.request.sort_by eq 'branch_code'}selected {/if}>Branch Code</option>	<option value="stock_qty" {if $smarty.request.sort_by eq 'stock_qty'}selected {/if}>Stock Balance</option>	<option value="qty" {if $smarty.request.sort_by eq 'qty'}selected {/if}>Total Qty</option>	<option value="amt" {if $smarty.request.sort_by eq 'amt'}selected {/if}>Total Amount</option></select><span id="span_sort_order" {if !$smarty.request.sort_by}style="display:none;"{/if}><select name="sort_order">	<option value="asc" {if $smarty.request.sort_order eq 'asc'}selected {/if}>Ascending</option>	<option value="desc" {if $smarty.request.sort_order eq 'desc'}selected {/if}>Descending</option></select></span><p><input type="checkbox" name="compare_others" {if $smarty.request.compare_others}checked {/if} onChange="toggle_compare_others();" /> <b>Compare Total with</b><span class="span_month"><b>From</b> <input size=10 type=text name=date_from2 value="{$smarty.request.date_from2}" id="date_from2" readonly><img align=absmiddle src="ui/calendar.gif" id="t_added3" style="cursor: pointer;" title="Select Date">&nbsp;&nbsp;&nbsp;&nbsp;<b>To</b> <input size=10 type=text name=date_to2 value="{$smarty.request.date_to2}" id="date_to2" readonly><img align=absmiddle src="ui/calendar.gif" id="t_added4" style="cursor: pointer;" title="Select Date">&nbsp;&nbsp;&nbsp;&nbsp;<b>Group into 'Others'</b>{foreach from=$trade_discount_type item=tdc}{assign var=c value="group_others_`$tdc`"}<label><input type="checkbox" name="group_others_{$tdc}" {if $smarty.request.$c}checked{/if} value="1" />{$tdc}&nbsp;&nbsp;&nbsp;</label>{/foreach}</p><input type=hidden name=submit value=1><button name=show_report>{#SHOW_REPORT#}</button><button name=output_excel>{#OUTPUT_EXCEL#}</button><input type="checkbox" name="show_zero_row" {if $smarty.request.show_zero_row}checked {/if} /> <b>Show Zero Qty & Balance</b>{if $sessioninfo.privilege.SHOW_COST && $config.sku_listing_show_hq_cost && $BRANCH_CODE eq 'HQ'}	<input type=checkbox id="hq_cost_id" name=hq_cost value=1 {if $smarty.request.hq_cost}checked {/if}><label for="hq_cost_id"><b>HQ Cost</b></label>{/if}{if $config.enable_gst}<p>* Cost show in this report is GST exclusive.</p>{/if}</form><script>	toggle_compare_others();</script>{/if}{if !$table}{if $smarty.request.submit && !$err}-- No data --{/if}{else}<h2></h2><table class="report_table" width="100%"><tr class="header">	<th rowspan="2">Branch</th>	{assign var=cols value=2}	{if $sessioninfo.privilege.SHOW_COST}{assign var=cols value=$cols+1}{/if}	{foreach from=$label key=lbl item=c}	    <th colspan="{$cols}">{$c}</th>	{/foreach}	{assign var=cols value=2}	{if $sessioninfo.privilege.SHOW_COST}{assign var=cols value=$cols+1}{/if}	<th colspan="{$cols}">Total</th>	{if $smarty.request.compare_others}<th colspan="{$cols}">Total ({$smarty.request.date_to2})</th>{/if}	{assign var=cols value=2}	{if $sessioninfo.privilege.SHOW_REPORT_GP}{assign var=cols value=$cols+1}{/if}	<th colspan="{$cols}">{$smarty.request.date_to}</th>	{if $smarty.request.compare_others}<th colspan="{$cols}">{$smarty.request.date_to2}</th>{/if}</tr><tr class="header">	{foreach from=$label key=lbl item=c}		<th>Qty</th>		<th>Amount</th>		{if $sessioninfo.privilege.SHOW_COST}<th>Cost</th>{/if}	{/foreach}	<th>Qty</th>	<th>Amount</th>	{if $sessioninfo.privilege.SHOW_COST}<th>Cost</th>{/if}	{if $smarty.request.compare_others}	    <th>Qty</th>		<th>Amount</th>		{if $sessioninfo.privilege.SHOW_COST}<th>Cost</th>{/if}	{/if}	<th>Stock Balance</th>	<th>Closing Stock</th>	{if $sessioninfo.privilege.SHOW_REPORT_GP}<th>GP</th>{/if}	{if $smarty.request.compare_others}	    <th>Stock Balance</th>	    <th>Closing Stock</th>	    {if $sessioninfo.privilege.SHOW_REPORT_GP}<th>GP</th>{/if}	{/if}</tr>{foreach from=$bg_id_list item=bg_id}	{if count($bg_id_list)>1}	    <tr class="header">	        {assign var=colspan value=$type_col_count+5}	        {if $smarty.request.compare_others}			{assign var=colspan value=$colspan+4}			{if $sessioninfo.privilege.SHOW_COST}{assign var=colspan value=$colspan+1}{/if}			{if $sessioninfo.privilege.SHOW_REPORT_GP}{assign var=colspan value=$colspan+1}{/if}		{/if}	        {if $sessioninfo.privilege.SHOW_COST}{assign var=colspan value=$colspan+1}{/if}	        {if $sessioninfo.privilege.SHOW_REPORT_GP}{assign var=colspan value=$colspan+1}{/if}	        <th colspan="{$colspan}" style="text-align:left;">{$branch_group.header.$bg_id.code}</th>	    </tr>	{/if}	{foreach from=$branch_group.items.$bg_id item=b}		{assign var=bid value=$b.branch_id}		{if !$hide_branches.$bid}		<tr>			<td>{$b.code} - {$b.description}</td>			{foreach from=$label key=lbl item=c}				<td class="r">{$table.$bid.$lbl.qty|number_format|ifzero:'-'}</td>				<td class="r">{$table.$bid.$lbl.amt|number_format:2|ifzero:'-'}</td>				{if $sessioninfo.privilege.SHOW_COST}					<td class="r">{$table.$bid.$lbl.cost|number_format:$config.global_cost_decimal_points|ifzero:'-'}</td>				{/if}			{/foreach}						<td class="r total_col">{$table.$bid.total.qty|number_format|ifzero:'-'}</td>			<td class="r total_col">{$table.$bid.total.amt|number_format:2|ifzero:'-'}</td>			{if $sessioninfo.privilege.SHOW_COST}				<td class="r total_col">{$table.$bid.total.cost|number_format:$config.global_cost_decimal_points|ifzero:'-'}</td>			{/if}						{if $smarty.request.compare_others}				<td class="r total_col2">{$table.$bid.compared_total.qty|number_format|ifzero:'-'}</td>				<td class="r total_col2">{$table.$bid.compared_total.amt|number_format:2|ifzero:'-'}</td>				{if $sessioninfo.privilege.SHOW_COST}					<td class="r total_col2">{$table.$bid.compared_total.cost|number_format:$config.global_cost_decimal_points|ifzero:'-'}</td>				{/if}			{/if}						<td class="r">{$table.$bid.stock_qty|number_format}</td>			<td class="r">{$table.$bid.total_selling_price|number_format:2}</td>			{if $sessioninfo.privilege.SHOW_REPORT_GP}				<td class="r">{$table.$bid.total.gp_val|number_format:2}</td>			{/if}						{if $smarty.request.compare_others}				<td class="r total_col3">{$table.$bid.last_year_stock_qty|number_format}</td>				<td class="r total_col3">{$table.$bid.last_year_total_selling_price|number_format:2}</td>				{if $sessioninfo.privilege.SHOW_REPORT_GP}					<td class="r total_col3">{$table.$bid.compared_total.gp_val|number_format:2}</td>				{/if}			{/if}		</tr>		{/if}	{/foreach}		{if count($bg_id_list)>1}		<tr class="header">			<th class="r">Sub Total of {$branch_group.header.$bg_id.code}</th>			{foreach from=$label key=lbl item=c}				<td class="r">{$total.$bg_id.$lbl.qty|number_format|ifzero:'-'}</td>				<td class="r">{$total.$bg_id.$lbl.amt|number_format:2|ifzero:'-'}</td>				{if $sessioninfo.privilege.SHOW_COST}					<td class="r">{$total.$bg_id.$lbl.cost|number_format:$config.global_cost_decimal_points|ifzero:'-'}</td>				{/if}			{/foreach}						<td class="r">{$total.$bg_id.total.qty|number_format|ifzero:'-'}</td>			<td class="r">{$total.$bg_id.total.amt|number_format:2|ifzero:'-'}</td>			{if $sessioninfo.privilege.SHOW_COST}				<td class="r">{$total.$bg_id.total.cost|number_format:$config.global_cost_decimal_points|ifzero:'-'}</td>			{/if}						{if $smarty.request.compare_others}				<td class="r">{$total.$bg_id.compared_total.qty|number_format|ifzero:'-'}</td>				<td class="r">{$total.$bg_id.compared_total.amt|number_format:2|ifzero:'-'}</td>				{if $sessioninfo.privilege.SHOW_COST}					<td class="r">{$total.$bg_id.compared_total.cost|number_format:$config.global_cost_decimal_points|ifzero:'-'}</td>				{/if}			{/if}						<td class="r">{$total.$bg_id.stock_qty|number_format}</td>			<td class="r">{$total.$bg_id.total_selling_price|number_format:2}</td>			{if $sessioninfo.privilege.SHOW_REPORT_GP}				<td class="r">{$total.$bg_id.total.gp_val|number_format:2}</td>			{/if}						{if $smarty.request.compare_others}				<td class="r">{$total.$bg_id.last_year_stock_qty|number_format}</td>				<td class="r">{$total.$bg_id.last_year_total_selling_price|number_format:2}</td>				{if $sessioninfo.privilege.SHOW_REPORT_GP}					<td class="r">{$total.$bg_id.compared_total.gp_val|number_format:2}</td>				{/if}			{/if}		</tr>	{/if}{/foreach}<tr class="header">	<th class="r">Total</th>	{foreach from=$label key=lbl item=c}		<td class="r">{$total.total.$lbl.qty|number_format|ifzero:'-'}</td>		<td class="r">{$total.total.$lbl.amt|number_format:2|ifzero:'-'}</td>		{if $sessioninfo.privilege.SHOW_COST}			<td class="r">{$total.total.$lbl.cost|number_format:$config.global_cost_decimal_points|ifzero:'-'}</td>		{/if}	{/foreach}		<td class="r">{$total.total.total.qty|number_format|ifzero:'-'}</td>	<td class="r">{$total.total.total.amt|number_format:2|ifzero:'-'}</td>	{if $sessioninfo.privilege.SHOW_COST}		<td class="r">{$total.total.total.cost|number_format:$config.global_cost_decimal_points|ifzero:'-'}</td>	{/if}		{if $smarty.request.compare_others}		<td class="r">{$total.total.compared_total.qty|number_format|ifzero:'-'}</td>		<td class="r">{$total.total.compared_total.amt|number_format:2|ifzero:'-'}</td>		{if $sessioninfo.privilege.SHOW_COST}			<td class="r">{$total.total.compared_total.cost|number_format:$config.global_cost_decimal_points|ifzero:'-'}</td>		{/if}	{/if}		<td class="r">{$total.total.stock_qty|number_format}</td>	<td class="r">{$total.total.total_selling_price|number_format:2}</td>	{if $sessioninfo.privilege.SHOW_REPORT_GP}		<td class="r">{$total.total.total.gp_val|number_format:2}</td>	{/if}		{if $smarty.request.compare_others}		<td class="r">{$total.total.last_year_stock_qty|number_format}</td>		<td class="r">{$total.total.last_year_total_selling_price|number_format:2}</td>		{if $sessioninfo.privilege.SHOW_REPORT_GP}			<td class="r">{$total.total.compared_total.gp_val|number_format:2}</td>		{/if}	{/if}</tr></table>{/if}{include file=footer.tpl}{if !$no_header_footer}{literal}<script type="text/javascript">    Calendar.setup({        inputField     :    "date_from",     // id of the input field        ifFormat       :    "%Y-%m-%d",      // format of the input field        button         :    "t_added1",  // trigger for the calendar (button ID)        align          :    "Bl",           // alignment (defaults to "Bl")        singleClick    :    true    });    Calendar.setup({        inputField     :    "date_to",     // id of the input field        ifFormat       :    "%Y-%m-%d",      // format of the input field        button         :    "t_added2",  // trigger for the calendar (button ID)        align          :    "Bl",           // alignment (defaults to "Bl")        singleClick    :    true    });        Calendar.setup({        inputField     :    "date_from2",     // id of the input field        ifFormat       :    "%Y-%m-%d",      // format of the input field        button         :    "t_added3",  // trigger for the calendar (button ID)        align          :    "Bl",           // alignment (defaults to "Bl")        singleClick    :    true    });    Calendar.setup({        inputField     :    "date_to2",     // id of the input field        ifFormat       :    "%Y-%m-%d",      // format of the input field        button         :    "t_added4",  // trigger for the calendar (button ID)        align          :    "Bl",           // alignment (defaults to "Bl")        singleClick    :    true    });</script>{/literal}{/if}