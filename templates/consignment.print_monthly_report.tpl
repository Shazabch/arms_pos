{*5/20/2010 4:20:10 PM Andy- uncomment the checking for whether sku is up to date and edit the popup notice. (need config to turn on)5/23/2011 10:55:01 AM Alex- add sorting and group by category6/15/2011 9:51:45 AM Alex- get prefix settings for each branch*}{include file=header.tpl}{literal}<style></style>{/literal}<script>var phpself = '{$smarty.server.PHP_SELF}';{literal}function confirm_submit(){	$('span_checking').update('<img src=/ui/clock.gif align=absmiddle> Checking...');	document.f_mr.s.disabled = true;	new Ajax.Request(phpself+'?a=check_report',{	    parameters:{            year: document.f_mr.year.value,			month: document.f_mr.month.value,			branch_id: document.f_mr.branch.value		},		onComplete: function(e){			if(e.responseText=='found'){				if(confirm('They are some data entered for this month report, delete it and print a new blank form?')){				    document.f_mr.submit();				}			}			else if(e.responseText.indexOf('Inventory Notice:')>=0){				if(confirm(e.responseText)){				    document.f_mr.submit();				}				//alert('Inventorey is not updated yet. Please wait for 30 minutes and print again.');			}else if(e.responseText=='OK'){                if(confirm('Click OK to print')){				    document.f_mr.submit();				}			}else{				alert(e.responseText);			}			document.f_mr.s.disabled = false;			$('span_checking').update('');		}			});	//if(!confirm('Click OK to reset data and start print.'))  return false;	return false;}function load_from_branch(obj){	$('loading_id').update(_loading_);	new Ajax.Request(phpself+"?a=load_from_branch",{		parameters:{			branch: obj.value		},		onComplete: function(e){			$('loading_id').update('');			eval("json="+e.responseText);						if ($('con_sort_by_id')){				$('con_sort_by_id').value=json['con_sort_by'];			}						if ($('con_split_artno_id')){				if (json['con_split_artno']>0)	$('con_split_artno_id').checked=true;				else	$('con_split_artno_id').checked=false;			}						if ($('con_group_category_id')){				if (json['con_group_category']>0)	$('con_group_category_id').checked=true;				else	$('con_group_category_id').checked=false;			}		}	});}{/literal}</script><h1>{$PAGE_TITLE}</h1>{if $errm}	The following error(s) has occured:	<ul class="err">	{foreach from=$errm item=e}		<li> {$e}	{/foreach}	</ul>{/if}<form method="post" class="form" name="f_mr" target="_blank" onSubmit="return confirm_submit();"><input type="hidden" name="a" value="print_blank_form"><b>Month / Year :</b><select name="month">	{foreach from=$months key=k item=m}	    <option value="{$k}">{$m}</option>	{/foreach}</select><select name="year">	{foreach from=$years item=y}	    <option value="{$y}" {if $y eq $smarty.now|date_format:'%Y'}selected {/if}>{$y}</option>	{/foreach}</select>&nbsp;&nbsp;&nbsp;&nbsp;<b>Branch</b><select name="branch" id="branch_id" onchange="load_from_branch(this)">	{foreach from=$branches key=bid item=b}	    {if !$branch_group.have_group.$bid}	    	<option value="{$bid}" {if $bid eq $form.ci_branch_id}selected {/if}>{$b.code} - {$b.description}</option>	    {/if}	{/foreach}	{foreach from=$branch_group.header key=bgid item=bg}	    <optgroup label="{$bg.code}">	        {foreach from=$branch_group.items.$bgid key=bid item=b}	            <option value="{$bid}" {if $form.branch_id eq $bid}selected {/if}>{$b.code} - {$b.description}</option>	        {/foreach}	    </optgroup>	{/foreach}</select>&nbsp;&nbsp;<span id='loading_id'></span>&nbsp;&nbsp;<b>Sort by:</b> <select name="con_sort_by" id="con_sort_by_id">	<option value="artno" {if !$smarty.request.sort_by || $smarty.request.sort_by eq 'artno'} selected {/if} >Artno</option>	<option value="super" {if $smarty.request.sort_by eq 'super'} selected {/if}>Supermarket Code, Artno</option>	<option value="price" {if $smarty.request.sort_by eq 'price'} selected {/if}>Price, Artno</option></select>&nbsp;&nbsp;{if !$config.ci_use_split_artno}	<input id="con_split_artno_id" type="checkbox" name="con_split_artno" value="1" {if $smarty.request.con_split_artno}selected {/if} ><label for="split_artno_id"><b>Split artno</b></label>&nbsp;&nbsp;{/if}<input id="con_group_category_id" type="checkbox" name="con_group_category" value="1" {if $smarty.request.con_group_category}selected {/if} ><label for="group_category_id"><b>Group by category</b></label>&nbsp;&nbsp;<input type="submit" name="s" value="Print Report" /><span id="span_checking"></span></form><ul>	<li><a href="?a=print_empty" target=_blank>Click here</a> to generate an empty form.</li>	<li>Once you generate the print form, the data entered for that month will be lost.</li>	<li>Process will take few minute and please be patient.</li>	<li>Default settings can be changed at Branch masterfile.</li></ul><script>load_from_branch($('branch_id'))</script>{include file=footer.tpl}