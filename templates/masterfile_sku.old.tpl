{*Revision History================4 Apr 2007 - yinsee- 	check for $config.sku_application_require_multics to enable/disable multics code columns- 	replace 'Multics Code' with $config.link_code_name7/30/2007 2:27:26 PM - yinsee - add inventory popup*}{include file=header.tpl}{literal}<script>function show_inventory(id_type,id,bid){	curtain(true);	center_div('inv_popup');	$('inv_popup').style.display = '';	$('inv_popup').style.zIndex = 10000;	$('inv_list').innerHTML = '<img src=/ui/clock.gif align=absmiddle> Loading...';	new Ajax.Updater('inv_list','/sku.history.php?ajax=1&'+id_type+'='+id+'&branch_id='+bid);}function curtain_clicked(){	curtain(false);	$('inv_popup').style.display = 'none';}function save_linkcode(id,sku_id){	if ($('link_code['+id+']').value.trim() == '')	{	    alert('Field cannot be empty');	    $('link_code['+id+']').focus();		return;	}	new Ajax.Request(		"masterfile_sku.php",		{		    parameters: 'a=ajax_save_linkcode&sku_id='+sku_id+'&value='+$('link_code['+id+']').value,		    evalScripts: true,		    onComplete: function(t) {		        if (t.responseText != 'OK')		        {					alert(t.responseText);					$('link_code['+id+']').select();					$('link_code['+id+']').focus();				}				else				    $('td['+id+']').innerHTML = $('link_code['+id+']').value;			}		}	)}</script>{/literal}<h1>SKU Master File</h1><div id=inv_popup style="background:#fff;border:3px solid #000;width:500px;height:480px;position:absolute; padding:10px; display:none;"><div style="text-align:right"><img src=/ui/closewin.png onclick="curtain_clicked()"></div><div id=inv_list style="height:460px;"></div></div><p><form action="{$smarty.server.PHP_SELF}" method=get><b>Search SKU Application #ID</b> <input name=sku_id size=5 value="{$smarty.request.sku_id}"> <input type=submit value="Find"></form></p><form action="{$smarty.server.PHP_SELF}" method=get style="border:1px solid #eee;padding:5px"><table ><tr><td nowrap><b>Search</b> <input name=search_description value="{$smarty.request.search_description}" size=20><b>Application date From</b> <input type="text" name="from" value="{$smarty.request.from}" id="added1" readonly="1" size=12 /> <img align=absmiddle src="ui/calendar.gif" id="t_added1" style="cursor: pointer;" title="Select Date"/> &nbsp; <b>To</b> <input type="text" name="to" value="{$smarty.request.to}" id="added2" readonly="1" size=12 /> <img align=absmiddle src="ui/calendar.gif" id="t_added2" style="cursor: pointer;" title="Select Date"/><!-- calendar stylesheet --><link rel="stylesheet" type="text/css" media="all" href="js/jscalendar/calendar-blue.css" title="calendar-blue" /><!-- main calendar program --><script type="text/javascript" src="js/jscalendar/calendar.js"></script><!-- language for the calendar --><script type="text/javascript" src="js/jscalendar/lang/calendar-en.js"></script><!-- the following script defines the Calendar.setup helper function, which makes   adding a calendar a matter of 1 or 2 lines of code. --><script type="text/javascript" src="js/jscalendar/calendar-setup.js"></script>{literal}<script type="text/javascript">    Calendar.setup({        inputField     :    "added1",     // id of the input field        ifFormat       :    "%Y-%m-%d",      // format of the input field        button         :    "t_added1",  // trigger for the calendar (button ID)        align          :    "Bl",           // alignment (defaults to "Bl")        singleClick    :    true		//,        //onUpdate       :    load_data    });    Calendar.setup({        inputField     :    "added2",     // id of the input field        ifFormat       :    "%Y-%m-%d",      // format of the input field        button         :    "t_added2",  // trigger for the calendar (button ID)        align          :    "Bl",           // alignment (defaults to "Bl")        singleClick    :    true		//,        //onUpdate       :    load_data    });</script>{/literal}<p><!--input type=hidden name=a value="list"--><b>Filter by Branch</b><select name=branch_id><option value="">-- All --</option>{section name=i loop=$branch}<option value="{$branch[i].id}" {if $smarty.request.branch_id eq $branch[i].id}selected{/if}>{$branch[i].code}</option>{/section}</select>&nbsp;<b>Department</b><select name=department_id><option value="">-- All --</option>{section name=i loop=$dept}<option value="{$dept[i].id}" {if $smarty.request.department_id eq $dept[i].id}selected{/if}>{$dept[i].description}</option>{/section}</select>{if $config.sku_application_require_multics}&nbsp;<b>Status</b><select name=status><option value=''>-- All --</option><option value=0 {if $smarty.request.status eq '0'}selected{/if}>No {$config.link_code_name}</option><option value=1 {if $smarty.request.status eq '1'}selected{/if}>Have {$config.link_code_name}</option></select>{/if}&nbsp;{$pagination}</td><td><input type=submit name="s" value="Find"> <input type=button value="Print" onclick="window.open('{$smarty.server.PHP_SELF}?print=1&{$smarty.server.QUERY_STRING}')"></td></tr></table></form><br><div class="stdframe" id=udiv><table  border=0 cellpadding=2 cellspacing=1>{section name=i loop=$sku}<tr class=small bgcolor="{cycle name=r1 values="#ff9999,#99ff99"}"><th>ID#</th><th>SKU</th><th colspan=3>Category<br>(Note)</th><th {if !$config.sku_application_require_multics}colspan=6{/if}>Vendor</th>{if $config.sku_application_require_multics}<th>Multics<br>Dept</th><th>Multics<br>Section</th><th>Multics<br>Category</th><th>Multics<br>Brand</th><th>Multics<br>Price Type</th>{/if}</tr><tr class="small" bgcolor=#ffffff><th align=center>	{$sku[i].id}	<br><a href="masterfile_sku.php?a=view&id={$sku[i].id}" target=_blank>detail</a>	{if $sessioninfo.privilege.MST_SKU_UPDATE}	<br><a href="masterfile_sku.php?a=edit&id={$sku[i].id}" target=_blank>edit</a>	{/if}</td><td nowrap><img src="/ui/icons/table_key.png" align=absmiddle border=0 title="view inventory" onclick="show_inventory('sku_id',{$sku[i].id},'')"> {$sku[i].sku_code}{if $sku[i].approval_history_id>0 and $sessioninfo.level > 0}<br><a href="masterfile_sku_application.php?a=view&id={$sku[i].id}" target=_blank>application history</a>{/if}</td><td colspan=3>{$sku[i].cat_tree}{if $sku[i].note}<br><i style="color:#009">(Note: {$sku[i].note})</i>{/if}</td><td {if !$config.sku_application_require_multics}colspan=6{/if}>{$sku[i].vendor_code} - {$sku[i].vendor}</td>{if $config.sku_application_require_multics}<td>{$sku[i].multics_dept}</td><td>{$sku[i].multics_section}</td><td>{$sku[i].multics_category}</td><td>{$sku[i].multics_brand}</td><td align=center>{$sku[i].multics_pricetype}</td>{/if}</tr><tr class=small bgcolor="{cycle name=r2 values="#ffcccc,#ccffcc"}"><th colspan=2>SKU</th><th>{$config.link_code_name}</th><th>Artcile No.</th><th>MCode</th><th>Description</th><th>Selling</th>{if $sku[i].allowed_dept}<th>Cost</th><th>Profit</th><th>Mark On</th>{/if}<th>Price Type</th></tr>{assign var=items value=`$sku[i].items`}<tbody id=items[{$sku[i].id}]>{section name=j loop=$items}<tr onmouseover="this.bgColor='{#TB_ROWHIGHLIGHT#}';" onmouseout="this.bgColor='';" id="row[{$items[j].id}]"><td nowrap colspan=2><img src="/ui/icons/table_key.png" align=absmiddle border=0 title="view inventory" onclick="show_inventory('sku_item_id',{$items[j].id},'')"> {$items[j].sku_item_code}</td>{if preg_match("/0000$/", $items[j].sku_item_code)}{if $sessioninfo.privilege.MST_SKU_UPDATE}<td nowrap id="td[{$items[j].id}]"><input size=15 class=small id="link_code[{$items[j].id}]" value="{$items[j].link_code}"> <img src="ui/ok16.png" align=absmiddle onclick="save_linkcode('{$items[j].id}','{$items[j].sku_id}')" class="clickable"></td>{else}<td>{$items[j].link_code}</td>{/if}{else}<!-- not default item --><td>{$items[j].link_code}</td>{/if}<td>{$items[j].artno}</td><td>{$items[j].mcode}</td><td>{$items[j].description}</td><td>{$items[j].selling_price|number_format:2}</td>{if $sku[i].allowed_dept}<td>{$items[j].cost_price|number_format:4}</td><td>{$items[j].selling_price-$items[j].cost_price|number_format:3}</td>{assign var=gross value=`$items[j].selling_price-$items[j].cost_price`}<td>{if $items[j].selling_price}{$gross/$items[j].selling_price*100|number_format:2}%{/if}</td>{/if}<td align=center>{$items[j].default_trade_discount_code}</td></tr>{/section}</tbody>{/section}</table></div>{include file=footer.tpl}