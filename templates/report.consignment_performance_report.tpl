{*10/14/2011 5:44:53 PM Alex- Modified the Ctn and Pcs round up to base on config set.11/16/2011 4:36:32 PM Andy- Fix toggle "Use GRN" checkbox error.11/24/2011 2:33:43 PM Andy- Change "Use GRN" popup information message.4/28/2014 11:51 AM Fithri- add option to filter out inactive SKU items5/27/2014 3:27 PM Fithri- enhance all reports that have brand information to have brand group filter.06/30/2020 11:47 AM Sheila- Updated button css.*}{include file=header.tpl}{if !$no_header_footer}<style>{literal}.c1 { background:#ff9; }.c2 { background:none; }.r1 { background:#33ff99;}.r2 { background:#ff99ff;}.r3 { background:#33ff00;}.r4 { background:#3399ff;}{/literal}</style>{literal}<script>var LOADING = '<img src=/ui/clock.gif align=absmiddle> ';function get_brand(val,selected_id){	$('brand_select').innerHTML = LOADING;	if ($('all_category').checked) param = '&view_all=all_brand&selected='+selected_id;	else param = '&category_id='+val+'&selected='+selected_id;	new Ajax.Updater('brand_select','?a=ajax_get_brand_by_category_id'+param);}function toggle_sub(tbody_id, el){	if ($(tbody_id).style.display=='none')	{	    el.src='/ui/collapse.gif';	    $(tbody_id).style.display='';	}	else	{	    el.src='/ui/expand.gif';	    $(tbody_id).style.display='none';	}}function hide_or_show_brand(){	var type_choose = document.f_a.report_type.value;	if(type_choose=='brand'){		$('brand_label').style.display = '';	}else{        $('brand_label').style.display = 'none';	}}function check_use_grn(){	var allow_use_grn = true;		if(document.f_a['branch_id']){		if(!document.f_a['branch_id'].value)	allow_use_grn = false;	}		if(!document.f_a['vendor_id'].value)	allow_use_grn = false;		if(allow_use_grn){		$('inp_use_grn').disabled = false;	}else{		$('inp_use_grn').disabled = true;		$('inp_use_grn').checked = false;	}}</script>{/literal}{/if}<h1>{$PAGE_TITLE}</h1>{if $err}The following error(s) has occured:<ul class=err>{foreach from=$err item=e}<li> {$e}{/foreach}</ul>{/if}{if !$no_header_footer}<form method=post class=form name="f_a"><input type=hidden name=report_title value="{$report_title}"><b>Month</b> <select name=month>{section loop=12 name=i}	<option value="{$smarty.section.i.iteration}" {if $smarty.request.month eq $smarty.section.i.iteration}selected{/if}>{$months[$smarty.section.i.iteration]}</option>{/section}</select>&nbsp;<b>Year</b> <select name=year>{foreach from=$years item=y}    <option value="{$y.year}" {if $smarty.request.year eq $y.year}selected{/if}>{$y.year}</option>{/foreach}</select>{if $BRANCH_CODE eq 'HQ'}&nbsp;<b>Branch</b> <select name="branch_id" onChange="check_use_grn();">      <option value="">-- All --</option>	    {foreach from=$branches item=b}	        {if !$branch_group.have_group[$b.id]}	        <option value="{$b.id}" {if $smarty.request.branch_id eq $b.id}selected {/if}>{$b.code}</option>	        {/if}	    {/foreach}	    {foreach from=$branch_group.header key=bgid item=bg}	        <optgroup label="{$bg.code}">				{foreach from=$branch_group.items.$bgid key=bid item=r}					<option value="{$bid}" {if $smarty.request.branch_id eq $bid}selected {/if}>{$r.code}</option>				{/foreach}			</optgroup>		{/foreach}	</select>&nbsp;&nbsp;&nbsp;&nbsp;{/if}<p>{include file="category_autocomplete.tpl"  autocomplete_callback="get_brand($('category_id').value,'')" all=true}<p><b>Report Type</b><select name="report_type" onChange="hide_or_show_brand();">	<option value="brand" {if $smarty.request.report_type eq 'brand'} selected {/if}>Brand</option>	<option value="vendor" {if $smarty.request.report_type eq 'vendor'} selected {/if}>Vendor</option></select></p><b>Vendor</b><select name="vendor_id" onChange="check_use_grn();">{foreach from=$vendor item=r}<option value={$r.id} {if $smarty.request.vendor_id eq $r.id}selected{/if}>{$r.description} </option>{/foreach}</select>&nbsp;&nbsp;&nbsp;&nbsp;<input type=checkbox {if $smarty.request.GRN eq true}checked{/if} name=GRN id="inp_use_grn" /> <b>Use GRN</b> [<a href="javascript:void(0)" onclick="alert('{$LANG.USE_GRN_INFO|escape:javascript}')">?</a>]&nbsp;&nbsp;&nbsp;&nbsp;<label><input type="checkbox" name="exclude_inactive_sku" value="1" {if $smarty.request.exclude_inactive_sku}checked{/if} /><b>Exclude inactive SKU</b></label>&nbsp;&nbsp;&nbsp;&nbsp;<span id="brand_label" style="display:none;"><b>Brand</b><span id="brand_select"></span></span>&nbsp;&nbsp;&nbsp;&nbsp;</p><script>//get_brand(document.report_form.department_id.value,'{$smarty.request.brand_id}');hide_or_show_brand();get_brand($('category_id').value,'{$smarty.request.brand_id}');</script><input type=hidden name=submit value=1><button class="btn btn-primary" name=show_report>{#SHOW_REPORT#}</button>{if $sessioninfo.privilege.EXPORT_EXCEL eq '1'}<button class="btn btn-primary" name=output_excel>{#OUTPUT_EXCEL#}</button>{/if}</form><script>check_use_grn();</script>{/if}{if !$table}{if $smarty.request.submit && !$err}-- No data --{/if}{else}<h2>{$report_title}<br><!--Branch: {$branch_name|default:"All"}&nbsp;&nbsp;&nbsp;&nbsp;Vendor : {$vendor_name}&nbsp;&nbsp;&nbsp;&nbsp;Year: {$smarty.request.year}&nbsp;&nbsp;&nbsp;&nbsp;Month: {$months[$smarty.request.month]}--></h2><table class=report_table width=100%><tr class=header>	<th rowspan=2>ARMS Code<br>Art.No</th>	<th rowspan=2>Description</th>	<th rowspan=2>Type</th>	{section loop=16 name=i}	    <th>{$smarty.section.i.iteration}</th>	{/section}	<th rowspan=2>Total</th></tr><tr class=header>    {section loop=15 name=i}	    <th>{$smarty.section.i.iteration+16}</th>	{/section}	<th>&nbsp;</th></tr><!-- Start of Content-->{foreach from=$table key=code item=c}	<!-- Menu --><tr>	<td class="r4 r" colspan=3 rowspan=2>{$code} Sub Total	{if !$no_header_footer}	<img src=/ui/expand.gif onclick="toggle_sub('tbody_{$code}',this)">	{/if}	</td>	{section loop=16 name=i}	    {assign var=day value=$smarty.section.i.iteration}	    <td class="r1 r">			{$category2.$code.qty.$day|qty_nf|ifzero:'-'}<br>			{$category2.$code.amount.$day|number_format:2|ifzero:'-'}		</td>	{/section}	<td rowspan=2 class="r r4">	    {$category2.$code.qty.total|qty_nf|ifzero:'-'}<br>		{$category2.$code.amount.total|number_format:2|ifzero:'-'}	</td></tr><tr>    {section loop=15 name=i}        {assign var=day value=$smarty.section.i.iteration+16}	    <td class="r2 r">			{$category2.$code.qty.$day|qty_nf|ifzero:'-'}<br>			{$category2.$code.amount.$day|number_format:2|ifzero:'-'}		</td>	{/section}	<th>&nbsp;</th></tr>	<!-- End of Menu-->		<!-- Start of Tbody --><tbody style="display:none" id="tbody_{$code}">    {foreach from=$c key=s item=r}	    {cycle values="c2,c1" assign=row_class}	    <tr>	        <td class="{$row_class}">{$sku.$s.sku_item_code}</td>	        <td class="{$row_class}" rowspan=2>{$sku.$s.description}</td>	        <td class="{$row_class}" rowspan=2>{$code}</td>	        {assign var=day value=''}	        {section loop=16 name=i}			    {assign var=day value=$smarty.section.i.iteration}			    <td class="r r1">					{$r.qty.$day|qty_nf|ifzero:'-'}<br>					{$r.amount.$day|number_format:2|ifzero:'-'}				</td>			{/section}			<td rowspan=2 class="r {$row_class}">			    {$r.qty.total|qty_nf|ifzero:'-'}<br>				{$r.amount.total|number_format:2|ifzero:'-'}			</td>	    </tr>	    <tr>	        <td class="r {$row_class}">{$sku.$s.artno}</td>	        {assign var=day value=''}	        {section loop=15 name=i}		        {assign var=day value=$smarty.section.i.iteration+16}			    <td class="r r2">					{$r.qty.$day|qty_nf|ifzero:'-'}<br>					{$r.amount.$day|number_format:2|ifzero:'-'}				</td>			{/section}			<th>&nbsp;</th>	    </tr>	    	{/foreach}</tbody>		<!-- End of Tbody-->{/foreach}<!-- End of Content--><!-- Total--><tr>	<th rowspan=2 colspan=3 class="r4 r">Total</th>	{assign var=day value=''}    {section loop=16 name=i}    	{assign var=day value=$smarty.section.i.iteration}	    <td class="r r1">			{$category2.total.qty.$day|qty_nf|ifzero:'-'}<br>			{$category2.total.amount.$day|number_format:2|ifzero:'-'}		</td>	{/section}	<td rowspan=2 class="r r4">	    {$category2.total.qty.total|qty_nf|ifzero:'-'}<br>		{$category2.total.amount.total|number_format:2|ifzero:'-'}	</td></tr><tr>	{assign var=day value=''}    {section loop=15 name=i}       {assign var=day value=$smarty.section.i.iteration+16}	    <td class="r r2">			{$category2.total.qty.$day|qty_nf|ifzero:'-'}<br>			{$category2.total.amount.$day|number_format:2|ifzero:'-'}		</td>	{/section}	<th>&nbsp;</th></tr><!-- End of Total--></table>{/if}{include file=footer.tpl}