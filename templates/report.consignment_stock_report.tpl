{*1/6/2010 4:52:12 PM Andy- Add config 'ci_use_split_artno' to check whether split artno9/23/2010 4:38:37 PM Andy- Add sort by price type.- Add group data by branch group.- Price type, selling and cost will show using hq if group by branch.2/8/2011 11:19:02 AM Andy- Add show legend and remark when use HQ price type, cost and selling.5/12/2011 12:04:33 PM Alex- add use hq cost only2/4/2013 5:34 PM Justin- Enhanced to show and filter branches from regions or branch group base on user's regions.12/2/2014 5:03 PM Justin- Add a legend to let user know the selling/cost price is before GST.07/01/2016 14:00 Edwin- Show 'HQ Cost' when branch is HQ and $config.sku_listing_show_hq_cost is enabled*}{include file=header.tpl}{if !$no_header_footer}<style>{literal}.total_col{	background-color:#ff9;}option.bg{	font-weight:bold;	padding-left:10px;}option.bg_item{	padding-left:20px;}.sup1{	color:red;}{/literal}</style><script>var sort_by = '{$smarty.request.sort_by}';var phpself = '{$smarty.server.PHP_SELF}';{literal}function change_sort_by(ele){	if(ele.value=='')   $('span_sort_order').hide();	else    $('span_sort_order').show();}{/literal}</script>{/if}<h1>{$PAGE_TITLE}</h1>{if $err}The following error(s) has occured:<ul class=err>{foreach from=$err item=e}<li> {$e}</li>{/foreach}</ul>{/if}{if !$no_header_footer}<form method=post class=form name="f_a"><b>Branch</b><select name="branch_id" id="branch_id"><!--<option value=''>-- All --</option>-->{foreach from=$branches key=bid item=r}	{if !$branches_group.have_group.$bid}		<option value="{$bid}" {if $bid eq $smarty.request.branch_id}selected {/if}>{$r.code} - {$r.description}</option>	{/if}{/foreach}{if $branches_group.header}	<optgroup label='Branch Group'>	{foreach from=$branches_group.header key=bgid item=bg}			<option class="bg" value="{$bgid*-1}"{if $smarty.request.branch_id eq ($bgid*-1)}selected {/if}>{$bg.code}</option>			{foreach from=$branches_group.items.$bgid item=r}				<option class="bg_item" value="{$r.branch_id}" {if $smarty.request.branch_id eq $r.branch_id}selected {/if}>{$r.code} - {$r.description}</option>			{/foreach}		{/foreach}	</optgroup>{/if}{if $config.consignment_modules && $config.masterfile_branch_region}	<optgroup label='Region'>	{foreach from=$config.masterfile_branch_region key=type item=f}		{if ($sessioninfo.regions && $sessioninfo.regions.$type) || !$sessioninfo.regions}			{assign var=curr_type value="REGION_`$type`"}			<option value="REGION_{$type}" {if $smarty.request.branch_id eq $curr_type}selected {/if}>{$type|upper}</option>		{/if}	{/foreach}	</optgroup>{/if}</select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>Month</b> <select name=month>{section loop=12 name=i}	<option value="{$smarty.section.i.iteration}" {if $smarty.request.month eq $smarty.section.i.iteration}selected{/if}>{$months[$smarty.section.i.iteration]}</option>{/section}</select>&nbsp;&nbsp;&nbsp;<b>Year</b> <select name=year>{foreach from=$years item=y}    <option value="{$y.year}" {if $smarty.request.year eq $y.year}selected{/if}>{$y.year}</option>{/foreach}</select>&nbsp;<b>Sort by</b><select name="sort_by" onChange="change_sort_by(this);">	<option value="">--</option>	<option value="sku_item_code" {if $smarty.request.sort_by eq 'sku_item_code'}selected {/if}>ARMS Code</option>    <option value="artno" {if $smarty.request.sort_by eq 'artno'}selected {/if}>Art No</option>    <option value="mcode" {if $smarty.request.sort_by eq 'mcode'}selected {/if}>MCode</option>    <!--option value="linkcode" {if $smarty.request.sort_by eq 'linkcode'}selected {/if}>CM Code</option-->    <option value="description" {if $smarty.request.sort_by eq 'description'}selected {/if}>Description</option>    <option value="discount_code" {if $smarty.request.sort_by eq 'discount_code'}selected {/if}>Price Type</option></select><span id="span_sort_order" {if !$smarty.request.sort_by}style="display:none;"{/if}><select name="sort_order">	<option value="asc" {if $smarty.request.sort_order eq 'asc'}selected {/if}>Ascending</option>	<option value="desc" {if $smarty.request.sort_order eq 'desc'}selected {/if}>Descending</option></select></span><p>{include file="category_autocomplete.tpl" all=true}</p><input type=hidden name=submit value=1><button name=show_report>{#SHOW_REPORT#}</button><button name=output_excel>{#OUTPUT_EXCEL#}</button><input type="checkbox" id="hide_zero_id" name="hide_zero" {if $smarty.request.hide_zero}checked {/if}/><label for="hide_zero_id"><b>Hide Zero Qty</b></label>{if $sessioninfo.privilege.SHOW_COST}	<input type="checkbox" id="hide_cost_id" name="hide_cost" {if $smarty.request.hide_cost}checked {/if}/><label for="hide_cost_id"><b>Hide Cost</b></label>	{if $config.sku_listing_show_hq_cost && $BRANCH_CODE eq 'HQ'}		<input type=checkbox id="hq_cost_id" name=hq_cost value=1 {if $smarty.request.hq_cost}checked {/if}><label for="hq_cost_id"><b>HQ Cost</b></label>	{/if}{/if}{if $config.enable_gst}	<p>		* Selling and cost price show in this report is GST exclusive.	</p>{/if}</form>{/if}{if !$table}{if $smarty.request.submit && !$err}-- No data --{/if}{else}<h2>{*Category: {$cat_desc} &nbsp;&nbsp;&nbsp;&nbsp;Branch: {$branches[$smarty.request.branch_id].code}*}{$report_title}</h2>{if $use_hq_cost_selling || $smarty.request.hq_cost}<ul>	{if $use_hq_cost_selling}	<li class="sup1">				<sup>1</sup> 		Price Type{if !$smarty.request.hq_cost}, Cost Price{/if} and Selling Price is based on HQ if group by branch.		</li>	{/if}	{if $smarty.request.hq_cost}	<li class="sup1">				<sup>2</sup> 		Cost Price is based on HQ Cost.	</li>	{/if}</ul>{/if}<table width="100%" class="report_table">	<tr class="header">	    <th rowspan="2"></th>	    <th rowspan="2">ARMS Code</th>	    <th rowspan="2">MCode</th>	    <th {if $config.ci_use_split_artno}colspan="2"{else}rowspan="2"{/if}>Art.No</th>	    <th rowspan="2">Description</th>        <th rowspan="2">{if $use_hq_cost_selling}<sup class="sup1">1</sup>{/if} Price Type</th>        {if !$smarty.request.hide_cost and $sessioninfo.privilege.SHOW_COST}<th rowspan="2">{if $smarty.request.hq_cost}<sup class="sup1">2</sup>{elseif $use_hq_cost_selling}<sup class="sup1">1</sup>{/if} Cost Price</th>{/if}	    <th rowspan="2">{if $use_hq_cost_selling}<sup class="sup1">1</sup>{/if} Selling Price</th>	    <th rowspan="2">Stock</th>	    {if !$smarty.request.hide_cost and $sessioninfo.privilege.SHOW_COST}<th rowspan="2">Total Cost</th>{/if}	    <th rowspan="2">Total Selling</th>	</tr>	<tr class="header">	    {if $config.ci_use_split_artno}	    <th>Code</th>	    <th>Size</th>	    {/if}	</tr>	{foreach from=$table item=r name=f}	    <tr>	        <td>{$smarty.foreach.f.iteration}</td>	        <td>{$r.sku_item_code}</td>	        <td>{$r.mcode}</td>	        {if $config.ci_use_split_artno}		        <td>{$r.artno_code}</td>		        <td>{$r.artno_size}</td>	        {else}	            <td>{$r.artno|replace:' ':'&nbsp;'}</td>	        {/if}	        <td>{$r.description}</td>	        <td style="text-align:center;">{$r.discount_code}</td>	        {if !$smarty.request.hide_cost and $sessioninfo.privilege.SHOW_COST}	        	<td class="r">{$r.cost_price|number_format:2}</td>	        {/if}	        <td class="r">{$r.selling_price|number_format:2}</td>	        <td class="r">{$r.qty|number_format}</td>	        {if !$smarty.request.hide_cost and $sessioninfo.privilege.SHOW_COST}	        	<td class="r total_col">{$r.total_cost_price|number_format:2}</td>	        {/if}	        <td class="r total_col">{$r.total_selling_price|number_format:2}</td>	    </tr>	{/foreach}	<tr class="header">	    {assign var=cols value=6}	    {if $config.ci_use_split_artno}	        {assign var=cols value=$cols+1}		{/if}	    <th colspan="{$cols}" class="r">Total</th>	    {if !$smarty.request.hide_cost and $sessioninfo.privilege.SHOW_COST}	    	<td class="r">{$total.cost_price|number_format:2}</td>	    {/if}	    <td class="r">{$total.selling_price|number_format:2}</td>        <td class="r">{$total.qty|number_format}</td>        {if !$smarty.request.hide_cost and $sessioninfo.privilege.SHOW_COST}        	<td class="r">{$total.total_cost_price|number_format:2}</td>        {/if}	    <td class="r">{$total.total_selling_price|number_format:2}</td>	</tr></table>{/if}{include file=footer.tpl}