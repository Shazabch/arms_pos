{*11/23/2012 2:17:00 PM Fithri- after monthly report has been printed, user cannot do further edit (reject, approval or submit) on that month - for consignment only8/1/2013 4:11 PM Andy- Change to prompt error if the ci is not allow to approve/reject.12/23/2013 10:23 AM Fithri- new module 'Stucked Documents Approval'*}{include file=header.tpl}{literal}<script type="text/javascript">function ci_cancel(){	document.f_b.comment.value = '';	var p = prompt('Enter reason to terminate/Cancel:');	if (p.trim()=='' || p==null) return;	document.f_b.comment.value = p;	if (confirm('Press OK to Terminate/Cancel this Consignment Invoice.')){		document.f_b.a.value = "cancel";		document.f_b.submit();	}}function ci_approve(){	new Ajax.Request("consignment_invoice_approval.php",{		method:'post',		parameters: 'a=check_printed_report&curr_date='+document.f_b.curr_date.value+'&branch_id='+document.f_b.branch_id.value,	    evalScripts: true,		onComplete: function (e) {			var resp = e.responseText.trim();			if (resp == '0') {				document.f_b.comment.value = 'Approve';				if (confirm('Press OK to Approve the Consignment Invoice.')){					document.f_b.a.value = "approve";					document.f_b.submit();				}			}			else{				//$('errpr').innerHTML = resp;				alert(resp);			}     	}	});}function ci_reject(){	new Ajax.Request("consignment_invoice_approval.php",{		method:'post',		parameters: 'a=check_printed_report&curr_date='+document.f_b.curr_date.value+'&branch_id='+document.f_b.branch_id.value,	    evalScripts: true,		onComplete: function (e) {			var resp = e.responseText.trim();			if (resp == '0') {				document.f_b.comment.value = '';				var p = prompt('Enter reason to reject:');				if (!p || p.trim()=='' || p==null) return;				document.f_b.comment.value = p;				if (confirm('Press OK to Reject the Consignment Invoice.')){					document.f_b.a.value = "reject";					document.f_b.submit();				}			}			else{				//$('errpr').innerHTML = resp;				alert(resp);			}     	}	});}function select_tab(obj){	if (obj == undefined){		var lst = $('tab').getElementsByTagName("LI");		if (lst.length==0){			alert('Congratulation! You have completed all approval jobs.\nTake a break ;)');			document.location = '/home.php';			return;		}		lst[0].className = "active";		load_approval(lst[0]);	}	else{		var lst = $('tab').getElementsByTagName("LI");		$A(lst).each( function(r,idx) {			if (r.className == "active")				r.className = '';		});		obj.className = "active";		load_approval(obj);	}}function load_approval(obj){    var line = obj.title.split(",");	id =line[0];	branch_id = line[1];	//alert(ci_no);	$('sel_name').innerHTML = obj.innerHTML;	$('udiv').innerHTML = '<img src=ui/clock.gif align=absmiddle> Loading...<br><img src=ui/pixel.gif height=500 width=1>';	new Ajax.Updater('udiv', 'consignment_invoice_approval.php', {		parameters: 'a=ajax_load_ci&id='+id+'&branch_id='+branch_id+'&'+Form.serialize(document.f_on_behalf),		evalScripts: true		});}</script><style>#tab_sel {	border:1px solid #ccc;	width:500px;	padding:4px;	background:#fff url('/ui/findcat_expand.png') right center no-repeat;}#tab_sel ul {	position:absolute;	visibility:hidden;	background:#fff;	border:1px solid #ccc;	border-top:none;	list-style:none;	margin:0;padding:0;	margin-left:-5px;	margin-top:5px;	width:508px;	height:300px;	overflow:auto;}#tab_sel ul li {	cursor:pointer;	display:block;	margin:0;padding:4px;}#tab_sel ul li:hover {	background:#ff9}#tab_sel:hover ul {	visibility:visible;}</style>{/literal}<h1>{$PAGE_TITLE}{if $approval_on_behalf} (on behalf of {$approval_on_behalf.on_behalf_of_u}){/if}</h1><div style="float:left;padding:4px;"><b>Select Consignment Invoice to approve</b></div><div style="float:left" id=tab_sel><span id=sel_name>-</span><ul id=tab>{section name=i loop=$ci}{strip}<li onclick="select_tab(this)" id="tab{$ci[i].id}" title="{$ci[i].id},{$ci[i].branch_id}"> &nbsp; {$ci[i].prefix}{$ci[i].id|string_format:"%05d"} &nbsp; (To: {if $ci[i].ci_branch_id}{$ci[i].ci_branch_name}{else}{$ci[i].open_info.name}{/if}, Date: {$ci[i].ci_date}, Created By: {$ci[i].user_name})</li>{/strip}{/section}</ul></span></div><br style="clear:both"><br><form name="f_on_behalf">	{if $approval_on_behalf}	<input type="hidden" name="on_behalf_of" value="{$approval_on_behalf.on_behalf_of}" />	<input type="hidden" name="on_behalf_by" value="{$approval_on_behalf.on_behalf_by}" />	{/if}</form><div id=udiv><!-- data will be loaded here --></div><script>select_tab();</script>{include file=footer.tpl}