{*1/6/2010 5:02:14 PM Andy- Add config 'ci_use_split_artno' to check whether split artno5/12/2011 3:44:17 PM Alex- add use hq_cost12/2/2014 5:03 PM Justin- Add a legend to let user know the selling/cost price is before GST.07/01/2016 14:00 Edwin- Show 'HQ Cost' when branch is HQ and $config.sku_listing_show_hq_cost is enabled*}{include file=header.tpl}{literal}<!-- calendar stylesheet --><link rel="stylesheet" type="text/css" media="all" href="js/jscalendar/calendar-blue.css" title="calendar-blue" /><!-- main calendar program --><script type="text/javascript" src="js/jscalendar/calendar.js"></script><!-- language for the calendar --><script type="text/javascript" src="js/jscalendar/lang/calendar-en.js"></script><!-- the following script defines the Calendar.setup helper function, which makes   adding a calendar a matter of 1 or 2 lines of code. --><script type="text/javascript" src="js/jscalendar/calendar-setup.js"></script>{/literal}{if !$no_header_footer}<style>{literal}.total_col{	background-color:#ff9;}{/literal}</style><script>var sort_by = '{$smarty.request.sort_by}';var phpself = '{$smarty.server.PHP_SELF}';{literal}function change_sort_by(ele){	if(ele.value=='')   $('span_sort_order').hide();	else    $('span_sort_order').show();}function toggle_hq_cost(val){	if (val == 1)		$('hq_cost_id').enable();	else		$('hq_cost_id').disable();}{/literal}</script>{/if}<h1>{$PAGE_TITLE}</h1>{if $err}The following error(s) has occured:<ul class=err>{foreach from=$err item=e}<li> {$e}{/foreach}</ul>{/if}{if !$no_header_footer}<form method=post class=form name="f_a"><b>Date</b>&nbsp;<b>From</b> <input size=10 type=text name=date_from value="{$smarty.request.date_from}" id="date_from"><img align=absmiddle src="ui/calendar.gif" id="t_added1" style="cursor: pointer;" title="Select Date">&nbsp;&nbsp;&nbsp;&nbsp;<b>To</b> <input size=10 type=text name=date_to value="{$smarty.request.date_to}" id="date_to"><img align=absmiddle src="ui/calendar.gif" id="t_added2" style="cursor: pointer;" title="Select Date">&nbsp;&nbsp;&nbsp;&nbsp;<p><b>Branch</b><select name="branch_id" id="branch_id" onchange="toggle_hq_cost(this.value);">	{foreach from=$branches key=bid item=b}	    {if !$branch_group.have_group.$bid}	    	<option value="{$bid}" {if $bid eq $smarty.request.branch_id}selected {/if}>{$b.code} - {$b.description}</option>	    {/if}	{/foreach}	{foreach from=$branch_group.header key=bgid item=bg}	    <optgroup label="{$bg.code}">	        {foreach from=$branch_group.items.$bgid key=bid item=b}	            <option value="{$bid}" {if $bid eq $smarty.request.branch_id}selected {/if}>{$b.code} - {$b.description}</option>	        {/foreach}	    </optgroup>	{/foreach}</select>&nbsp;<b>Show by</b><select name="show_by">	<option value="daily" {if $smarty.request.show_by eq 'daily'}selected {/if}>Daily</option>	<option value="weekly" {if $smarty.request.show_by eq 'weekly'}selected {/if}>Weekly</option>	<option value="monthly" {if $smarty.request.show_by eq 'monthly'}selected {/if}>Monthly</option></select>&nbsp;<b>Sort by</b><select name="sort_by" onChange="change_sort_by(this);">	<option value="">--</option>	<option value="sku_item_code" {if $smarty.request.sort_by eq 'sku_item_code'}selected {/if}>ARMS Code</option>    <option value="artno" {if $smarty.request.sort_by eq 'artno'}selected {/if}>Art No</option>    <option value="mcode" {if $smarty.request.sort_by eq 'mcode'}selected {/if}>MCode</option>    <!--option value="linkcode" {if $smarty.request.sort_by eq 'linkcode'}selected {/if}>CM Code</option-->    <option value="description" {if $smarty.request.sort_by eq 'description'}selected {/if}>Description</option></select><span id="span_sort_order" {if !$smarty.request.sort_by}style="display:none;"{/if}><select name="sort_order">	<option value="asc" {if $smarty.request.sort_order eq 'asc'}selected {/if}>Ascending</option>	<option value="desc" {if $smarty.request.sort_order eq 'desc'}selected {/if}>Descending</option></select></span></p><p><input type=hidden name=submit value=1><button name=show_report>{#SHOW_REPORT#}</button><button name=output_excel>{#OUTPUT_EXCEL#}</button>{if $sessioninfo.privilege.SHOW_COST && $config.sku_listing_show_hq_cost && $BRANCH_CODE eq 'HQ'}	<input type=checkbox id="hq_cost_id" name=hq_cost value=1 {if $smarty.request.hq_cost}checked {/if}><label for="hq_cost_id"><b>HQ Cost</b></label>{/if}<br />Note:<br />* Report Maximum shown 1 year{if $config.enable_gst}<br />* Selling price show in this report is GST exclusive.{/if}</p></form>{/if}{if !$table}{if $smarty.request.submit && !$err}-- No data --{/if}{else}<h2>Branch: {$branches[$smarty.request.branch_id].code}&nbsp;&nbsp;&nbsp;&nbsp;Date From: {$smarty.request.date_from} To {$smarty.request.date_to}&nbsp;&nbsp;&nbsp;&nbsp;Show by: {$smarty.request.show_by}</h2><table width="100%" class="report_table">	<tr class="header">	    <th rowspan="2">&nbsp;</th>     	<th rowspan="2">ARMS Code</th>	    <th rowspan="2">MCode</th>	    <th {if $config.ci_use_split_artno}colspan="2"{else}rowspan="2"{/if}>Art.No</th>	    <th rowspan="2">Description</th>	    {foreach from=$label item=lbl}	        {if $smarty.request.show_by eq 'daily'}	            {if $last_month ne $lbl|date_format:'%m'}	            	{assign var=last_month value=$lbl|date_format:'%m'}                    <th rowspan="2">{$lbl|date_format:'%b<br>%d'}</th>				{else}				    <th rowspan="2">{$lbl|date_format:'%d'}</th>	            {/if}	        {else}	        	<th rowspan="2">{if $smarty.request.show_by eq 'weekly'}W{/if}{$lbl}</th>	        {/if}	    {/foreach}	    {if $smarty.request.branch_id eq 1}	    	{if $smarty.request.hq_cost}	    		<th rowspan="2">HQ Cost</th>	    	{else}			    <th rowspan="2">Last GRN Cost</th>			    <th rowspan="2">Last AVG Cost</th>			{/if}	    {/if}	    <th rowspan="2">Selling<br>Price</th>	    <th rowspan="2">Total Qty</th>	    <th rowspan="2">Total<br>Selling<br>Price</th>	</tr> 	<tr class="header"> 	    {if $config.ci_use_split_artno}	    <th>Code</th>	    <th>Size</th>	    {/if}	</tr>	{foreach from=$sku_items_info item=r name=f}	    {assign var=sid value=$r.sid}	    <tr>	        <td>{$smarty.foreach.f.iteration}</td>        	<td>{$r.sku_item_code}</td>	        <td>{$r.mcode}</td>	        {if $config.ci_use_split_artno}		        <td>{$r.artno_code}</td>		        <td>{$r.artno_size}</td>	        {else}	            <td>{$r.artno}</td>	        {/if}	        <td>{$r.description}</td>	        {foreach from=$label item=lbl}	            <td class="r">{$table.$sid.$lbl.qty|number_format|ifzero:''}</td>	        {/foreach}	        {if $smarty.request.branch_id eq 1}       	    	{if $smarty.request.hq_cost}		    		<td class="r">{$cost.$sid.hq_cost|number_format:2}</td>		    	{else}			        <td class="r">{$cost.$sid.grn_cost|number_format:2}</td>			        <td class="r">{$cost.$sid.avg_cost|number_format:2}</td>			    {/if}	        {/if}	        <td class="r">{$price.$sid|number_format:2}</td>	        <td class="r total_col">{$total.$sid.total.qty|number_format|ifzero:''}</td>	        <td class="r total_col">{$total.$sid.total_selling_price|number_format:2}</td>	    </tr>	{/foreach}	<tr class="header">	    {assign var=cols value=5}	    {if $config.ci_use_split_artno}	        {assign var=cols value=$cols+1}	    {/if}	    <th colspan="{$cols}" class="r">Total</th>        {foreach from=$label item=lbl}        	<td class="r">{$total.$lbl.qty|number_format|ifzero:''}</td>        {/foreach}        {if $smarty.request.branch_id eq 1}	    	{if $smarty.request.hq_cost}	    		<th class="r">{$total.total.hq_cost|number_format:2}</th>	    	{else}		        <th class="r">{$total.total.grn_cost|number_format:2}</th>		        <th class="r">{$total.total.avg_cost|number_format:2}</th>	        {/if}        {/if}        <th class="r">{$total.total.selling_price|number_format:2|ifzero:''}</td>        <th class="r">{$total.total.total.qty|number_format|ifzero:''}</td>        <th class="r">{$total.total.total_selling_price|number_format:2|ifzero:''}</td>	</tr></table>{/if}{if !$no_header_footer}{literal}<script type="text/javascript">    Calendar.setup({        inputField     :    "date_from",     // id of the input field        ifFormat       :    "%Y-%m-%d",      // format of the input field        button         :    "t_added1",  // trigger for the calendar (button ID)        align          :    "Bl",           // alignment (defaults to "Bl")        singleClick    :    true    });    Calendar.setup({        inputField     :    "date_to",     // id of the input field        ifFormat       :    "%Y-%m-%d",      // format of the input field        button         :    "t_added2",  // trigger for the calendar (button ID)        align          :    "Bl",           // alignment (defaults to "Bl")        singleClick    :    true    });</script>{/literal}{/if}{include file=footer.tpl}<script>if ($('branch_id')) toggle_hq_cost($('branch_id').value);</script>